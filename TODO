fix function interactions with translate
break statements are still kinda ugly (meh I'll fix it with IR)